<!DOCTYPE html>
<html>

<head>
    <title>MyTeacher - Registrazione</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>

    <script src="script_header.js"></script>
    <script src="script_ricerca.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>

    <link rel="stylesheet"
        href="https://mdbcdn.b-cdn.net/wp-content/themes/mdbootstrap4/docs-app/css/dist/mdb5/standard/core.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css"
        integrity="sha256-3sPp8BkKUE7QyPSl6VfBByBroQbKxKG7tsusY2mhbVY=" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js"></script>
    </script>


    <style>
        .myTeacherlogo {

            font-family: 'Tahoma';
            font-style: normal;
            font-weight: 900;
            font-size: 3rem;
            line-height: 63px;
            /* identical to box height */
            text-align: center;

            color: #F40000;

            -webkit-text-stroke: 1px black;

        }

        .hide_div {
            opacity: 0;
        }

        .show_div {
            opacity: 100;
        }

        body {
            background: #f5f5f5;
            margin-top: 20px;
        }

        /* ===== Career ===== */
        .career-form {
            background-color: #4e63d7;
            border-radius: 5px;
            padding: 0 16px;
        }

        .career-form .form-control {
            background-color: rgba(255, 255, 255, 0.2);
            border: 0;
            padding: 12px 15px;
            color: #fff;
        }

        .career-form .form-control::-webkit-input-placeholder {
            /* Chrome/Opera/Safari */
            color: #fff;
        }

        .career-form .form-control::-moz-placeholder {
            /* Firefox 19+ */
            color: #fff;
        }

        .career-form .form-control:-ms-input-placeholder {
            /* IE 10+ */
            color: #fff;
        }

        .career-form .form-control:-moz-placeholder {
            /* Firefox 18- */
            color: #fff;
        }

        .career-form .custom-select {
            background-color: rgba(255, 255, 255, 0.2);
            border: 0;
            padding: 12px 15px;
            color: #fff;
            width: 100%;
            border-radius: 5px;
            text-align: left;
            height: auto;
            background-image: none;
        }

        .career-form .custom-select:focus {
            -webkit-box-shadow: none;
            box-shadow: none;
        }

        .career-form .select-container {
            position: relative;
        }

        .career-form .select-container:before {
            position: absolute;
            right: 15px;
            top: calc(50% - 14px);
            font-size: 18px;
            color: #ffffff;
            content: '\F2F9';
            font-family: "Material-Design-Iconic-Font";
        }

        .filter-result .job-box {
            -webkit-box-shadow: 0 0 35px 0 rgba(130, 130, 130, 0.2);
            box-shadow: 0 0 35px 0 rgba(130, 130, 130, 0.2);
            border-radius: 10px;
            padding: 10px 35px;
        }

        ul {
            list-style: none;
        }

        .list-disk li {
            list-style: none;
            margin-bottom: 12px;
        }

        .list-disk li:last-child {
            margin-bottom: 0;
        }

        .job-box .img-holder {
            height: 65px;
            width: 65px;
            background-color: #4e63d7;
            background-image: -webkit-gradient(linear, left top, right top, from(rgba(78, 99, 215, 0.9)), to(#5a85dd));
            background-image: linear-gradient(to right, rgba(78, 99, 215, 0.9) 0%, #5a85dd 100%);
            font-family: "Open Sans", sans-serif;
            color: #fff;
            font-size: 22px;
            font-weight: 700;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            border-radius: 65px;
        }

        .career-title {
            background-color: #4e63d7;
            color: #fff;
            padding: 15px;
            text-align: center;
            border-radius: 10px 10px 0 0;
            background-image: -webkit-gradient(linear, left top, right top, from(rgba(78, 99, 215, 0.9)), to(#5a85dd));
            background-image: linear-gradient(to right, rgba(78, 99, 215, 0.9) 0%, #5a85dd 100%);
        }

        .job-overview {
            -webkit-box-shadow: 0 0 35px 0 rgba(130, 130, 130, 0.2);
            box-shadow: 0 0 35px 0 rgba(130, 130, 130, 0.2);
            border-radius: 10px;
        }

        @media (min-width: 992px) {
            .job-overview {
                position: -webkit-sticky;
                position: sticky;
                top: 70px;
            }
        }

        .job-overview .job-detail ul {
            margin-bottom: 28px;
        }

        .job-overview .job-detail ul li {
            opacity: 0.75;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .job-overview .job-detail ul li i {
            font-size: 20px;
            position: relative;
            top: 1px;
        }

        .job-overview .overview-bottom,
        .job-overview .overview-top {
            padding: 35px;
        }

        .job-content ul li {
            font-weight: 600;
            opacity: 0.75;
            border-bottom: 1px solid #ccc;
            padding: 10px 5px;
        }

        @media (min-width: 768px) {
            .job-content ul li {
                border-bottom: 0;
                padding: 0;
            }
        }

        .job-content ul li i {
            font-size: 20px;
            position: relative;
            top: 1px;
        }

        .mb-30 {
            margin-bottom: 30px;
        }

        .image_print {
            max-height: 3.5rem;
            max-width: 3.5rem;
            min-height: 3.5rem;
            min-width: 3.5rem;
        }
    </style>
</head>

<body class="background" onload="includeHTML(); checkLoggedUser();">
    <div w3-include-html="header.html"></div>
    <div class="container mb-2">
        <div class="d-flex justify-content-center">
            <p>
                <button class="btn btn-lg btn-danger" type="button"
                    onclick="showCollapse('collapseStudent','collapseProfessor', 'student')">
                    Studente
                </button>
                <button class="btn btn-lg btn-danger" type="button"
                    onclick="showCollapse('collapseProfessor','collapseStudent', 'professor')">
                    Professore
                </button>
            </p>
        </div>
        <div id="hidden_div" class="hide_div">
            <div class="alert alert-danger d-flex align-items-center" role="alert">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    class="bi bi-exclamation-triangle-fill" viewBox="0 0 16 16">
                    <path
                        d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                </svg>
                <text style="color: hsla(0, 0%, 100%, 0)">12</text>
                <text id="alert_msg"></text>
            </div>
        </div>
        <div class="collapse" id="collapseStudent">
            <div class="card card-body">
                <div class="d-flex justify-content-center">
                    <div id="student_form" class="row g-3 needs-validation" novalidate>
                        <div class="col-md-4">
                            <label for="sfirstnameValidation" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="sfirstnameValidation" required>
                            <div class="invalid-feedback">
                                Per favore inserisci il tuo nome.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="slastnameValidation" class="form-label">Cognome</label>
                            <input type="text" class="form-control" id="slastnameValidation" required>
                            <div class="invalid-feedback">
                                Per favore inserisci il tuo cognome.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="susernameValidation" class="form-label">Username</label>
                            <div class="input-group has-validation">
                                <span style="background-color:#1166f1; color: white; border-color:#1166f1;"
                                    class="input-group-text" id="inputGroupPrepend">@</span>
                                <input type="text" class="form-control" id="susernameValidation"
                                    aria-describedby="inputGroupPrepend" required>
                                <div class="invalid-feedback">
                                    Per favore scegli uno username valido.
                                </div>
                                <div class="valid-feedback">
                                    Va bene!
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="semailValidation" class="form-label">Email</label>
                            <input type="text" class="form-control" id="semailValidation" required>
                            <div class="invalid-feedback">
                                Per favore inserisci un indirizzo email valido.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label for="sphoneValidation" class="form-label">Telefono</label>
                            <input type="text" class="form-control" id="sphoneValidation">
                            <div class="invalid-feedback">
                                Per favore inserisci un numero di telefono valido.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="spwValidation" class="form-label">Password</label>
                            <input type="password" class="form-control" id="spwValidation" required>
                            <div class="invalid-feedback">
                                Per favore inserisci una password valida.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="srpwValidation" class="form-label">Ripeti la password</label>
                            <input type="password" class="form-control" id="srpwValidation" required>
                            <div class="invalid-feedback">
                                Per favore ripeti la password.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="saccountPhoto" class="form-label">Scegli un'immagine profilo</label>
                            <input class="form-control" type="file" id="sinputFileToLoad">
                            <div class="invalid-feedback">
                                Per favore inserisci un file valido.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-danger" type="submit" onclick="resetFieldError()">Registrati</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="collapse" id="collapseProfessor">
            <div class="card card-body">
                <div class="d-flex justify-content-center">
                    <div id="professor_form" class="row g-3 needs-validation" novalidate>
                        <div class="col-md-4">
                            <label for="firstnameValidation" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="firstnameValidation" value="" required>
                            <div class="invalid-feedback">
                                Per favore inserisci il tuo nome.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="lastnameValidation" class="form-label">Cognome</label>
                            <input type="text" class="form-control" id="lastnameValidation" value="" required>
                            <div class="invalid-feedback">
                                Per favore inserisci il tuo cognome.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="usernameValidation" class="form-label">Username</label>
                            <div class="input-group has-validation">
                                <span style="background-color:#1166f1; color: white; border-color:#1166f1;"
                                    class="input-group-text" id="inputGroupPrepend">@</span>
                                <input type="text" class="form-control" id="usernameValidation"
                                    aria-describedby="inputGroupPrepend" value="" required>
                                <div class="invalid-feedback">
                                    Per favore scegli uno username valido.
                                </div>
                                <div class="valid-feedback">
                                    Va bene!
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="emailValidation" class="form-label">Email</label>
                            <input type="text" class="form-control" id="emailValidation" value="" required>
                            <div class="invalid-feedback">
                                Per favore inserisci un indirizzo email valido.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-3">
                            <label for="phoneValidation" class="form-label">Telefono</label>
                            <input type="text" class="form-control" id="phoneValidation" value="">
                            <div class="invalid-feedback">
                                Per favore inserisci un numero di telefono valido.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="pwValidation" class="form-label">Password</label>
                            <input type="password" class="form-control" id="pwValidation" value="" required>
                            <div class="invalid-feedback">
                                Per favore inserisci una password valida.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="rpwValidation" class="form-label">Ripeti la password</label>
                            <input type="password" class="form-control" id="rpwValidation" value="" required>
                            <div class="invalid-feedback">
                                Per favore ripeti la password.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="accountPhoto" class="form-label">Scegli un'immagine profilo</label>
                            <input class="form-control" type="file" id="inputFileToLoad" value="">
                            <div class="invalid-feedback">
                                Per favore inserisci un file valido.
                            </div>
                            <div class="valid-feedback">
                                Va bene!
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div id="subject-form">
                                <text id="subjects">Quali materie insegni?</text>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Algebra" id="checkAlgebra">
                                    <label class="form-check-label" for="checkAlgebra">
                                        Algebra
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Biologia" id="checkBiologia">
                                    <label class="form-check-label" for="checkBiologia">
                                        Biologia
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Chimica" id="checkChimica">
                                    <label class="form-check-label" for="checkChimica">
                                        Chimica
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Informatica"
                                        id="checkInformatica">
                                    <label class="form-check-label" for="checkInformatica">
                                        Informatica
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div id="topics-form">
                                <text id="topics">Quali argomenti insegni?</text>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Analisi 1"
                                        id="checkAnalisi1">
                                    <label class="form-check-label" for="checkAnalisi1">
                                        Analisi 1
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Python" id="checkPython">
                                    <label class="form-check-label" for="checkPython">
                                        Python
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Cellule" id="checkCellule">
                                    <label class="form-check-label" for="checkCellule">
                                        Cellule
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Tavola periodica"
                                        id="checkTavola">
                                    <label class="form-check-label" for="checkTavola">
                                        Tavola periodica
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="priceValidation" class="form-label">Inserisci un prezzo orario per le tue
                                lezioni</label>
                            <div class="input-group has-validation">
                                <input type="text" class="form-control" id="priceValidation" value="0.00">
                                <span style="background-color:#1166f1; color: white; border-color:#1166f1;"
                                    class="input-group-text" id="inputGroupPrepend">€</span>
                                <div class="invalid-feedback">
                                    Per favore inserisci un prezzo valido.
                                </div>
                                <div class="valid-feedback">
                                    Va bene!
                                </div>
                            </div>

                        </div>
                        <div class="col-12 py-3">
                            <button class="btn btn-danger" type="submit" onclick="resetFieldError()">Registrati</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal1 -->
        <div class="modal fade" data-bs-backdrop="static" id="Modal1" tabindex="-1" role="dialog"
            aria-labelledby="Modal1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        Congratulazioni, il tuo account è stato registrato correttamente!
                    </div>
                    <div class="d-flex justify-content-center modal-footer">
                        <button type="button" class="btn btn-primary" onclick="window.location = 'home.html'">Vai alla
                            home</button>
                    </div>
                </div>
            </div>
        </div>

    </div>






</body>

<script>
    professorAccount = false;

    /**
     * Show the proper form for the account to register
    **/
    function showCollapse(showName, hideName, type) {
        var showElemCollapse = document.getElementById(showName)
        var showbsCollapse = new bootstrap.Collapse(showElemCollapse, {
            toggle: true,
            show: true, //useless
            hide: false //useless
        })
        showbsCollapse.show();

        var hideElemCollapse = document.getElementById(hideName)
        var hidebsCollapse = new bootstrap.Collapse(hideElemCollapse, {
            toggle: false,
            show: false, //useless
            hide: true //useless
        })
        hidebsCollapse.hide()



        if (type == "professor") {
            professorAccount = true;
        } else {
            professorAccount = false;
        }

    }
    /**
     * Remove the error message from all the field before the new request
     * Then call the encodeImageFileURL function
    **/
    function resetFieldError() {
        var fields = document.getElementsByClassName("form-control is-invalid");
        for (var i = 0; i < fields.length; i++) {
            fields.item(i).className = "form-control";
        }
        document.getElementById("hidden_div").setAttribute("class", "hide_div");
        encodeImageFileAsURL();
    }


    /**
     * Convert an image in its Base64 version
     * Call the createJSON to create a JSON to send to the DB
    **/
    function encodeImageFileAsURL() {

        convertedPic = "";
        var filesSelected
        if (professorAccount) {
            filesSelected = document.getElementById("inputFileToLoad").files;
        } else {
            filesSelected = document.getElementById("sinputFileToLoad").files;

        }


        if (filesSelected.length > 0) {
            var fileToLoad = filesSelected[0];

            var fileReader = new FileReader();

            fileReader.onload = function (fileLoadedEvent) {
                var srcData = fileLoadedEvent.target.result; // <--- data: base64

                var newImage = document.createElement('img');
                newImage.src = srcData;

                convertedPic = newImage.outerHTML;
                console.log(convertedPic);
                convertedPic = convertedPic.slice(33, -2)
                //document.getElementById("imgTest").innerHTML = newImage.outerHTML;
                //alert("Converted Base64 version is " + convertedPic);
                createJSON(convertedPic);
            }
            fileReader.readAsDataURL(fileToLoad);

        } else {
            createJSON("");
        }


    }


    /**
     * Create a JSON with all the account data
     * Call registerNewUser to send the data to the DB
    **/
    function createJSON(imgBase64) {
        dataJSON = "";
        if (professorAccount) {
            aSubjects = ""
            if (document.getElementById("checkAlgebra").checked) {
                aSubjects = aSubjects + '"Algebra",'
            }
            if (document.getElementById("checkBiologia").checked) {

                aSubjects = aSubjects + '"Biologia",'
            }
            if (document.getElementById("checkChimica").checked) {

                aSubjects = aSubjects + '"Chimica",'
            }
            if (document.getElementById("checkInformatica").checked) {

                aSubjects = aSubjects + '"Informatica",'
            }

            aTopics = ""
            if (document.getElementById("checkAnalisi1").checked) {
                aTopics = aTopics + '"Analisi 1",'
            }
            if (document.getElementById("checkPython").checked) {
                aTopics = aTopics + '"Python",'
            }
            if (document.getElementById("checkCellule").checked) {
                aTopics = aTopics + '"Cellule",'
            }
            if (document.getElementById("checkTavola").checked) {
                aTopics = aTopics + '"Tavola periodica",'
            }

            aSubjects = aSubjects.slice(0, -1)
            aTopics = aTopics.slice(0, -1)


            fusername = document.getElementById("usernameValidation").value;
            fnome = document.getElementById("firstnameValidation").value;
            fcognome = document.getElementById("lastnameValidation").value;
            fprofessore = "" + professorAccount;
            femail = document.getElementById("emailValidation").value;
            fphone = document.getElementById("phoneValidation").value;
            fpassword = document.getElementById("pwValidation").value;
            frpassword = document.getElementById("rpwValidation").value;
            fimage = imgBase64;
            fsubject = "" + aSubjects;
            ftopic = "" + aTopics;
            fprezzo = document.getElementById("priceValidation").value;




            dataJSON = '{"username": "' + fusername +
                '", "nome": "' + fnome +
                '", "cognome": "' + fcognome +
                '", "professore": "' + fprofessore +
                '", "email": "' + femail;

            if (fphone != "") {
                dataJSON = dataJSON + '", "phone": "' + fphone;
            }
            dataJSON = dataJSON +
                '", "password": "' + fpassword +
                '", "repeatpassword": "' + frpassword +
                '", "image": "' + fimage +
                '", "materie": [' + fsubject +
                '], "argomenti": [' + ftopic +
                '], "prezzo": "' + fprezzo +
                '"}'

        } else {

            fusername = document.getElementById("susernameValidation").value;
            fnome = document.getElementById("sfirstnameValidation").value;
            fcognome = document.getElementById("slastnameValidation").value;
            fprofessore = "" + professorAccount;
            femail = document.getElementById("semailValidation").value;
            fphone = document.getElementById("sphoneValidation").value;
            fpassword = document.getElementById("spwValidation").value;
            frpassword = document.getElementById("srpwValidation").value;
            fimage = imgBase64;






            dataJSON = '{"username": "' + fusername +
                '", "nome": "' + fnome +
                '", "cognome": "' + fcognome +
                '", "professore": "' + fprofessore +
                '", "email": "' + femail;

            if (fphone != "") {
                dataJSON = dataJSON + '", "phone": "' + fphone;
            }
            dataJSON = dataJSON +
                '", "password": "' + fpassword +
                '", "repeatpassword": "' + frpassword +
                '", "image": "' + fimage +
                '"}'
        }


        //console.log(dataJSON)
        registerNewUser(dataJSON)



    }

    /**
     * Send the new user data to the DB
     * Wait the confirmation or error response from the DB
    **/
    function registerNewUser(json) {
        const xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            const json = this.responseText;
            var jsonData = JSON.stringify(json);
            const jsondoc = JSON.parse(json);
            //ALL OK, new user registered
            if (this.readyState == 4 && this.status == 201) {

                //link to new user
                linkNewUser = jsondoc.location;
                $("#Modal1").modal('toggle');


            } else if (this.readyState == 4 && this.status == 400) {

                //invalid request
                msg = jsondoc.message
                document.getElementById("hidden_div").setAttribute("class", "show_div");
                document.getElementById("alert_msg").innerHTML = msg



                if (msg == "Username non valido, deve essere una stringa alfanumerica") {
                    if (professorAccount) {
                        document.getElementById("usernameValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("susernameValidation").classList.add("is-invalid")
                    }
                } else if (msg == "L'email inserita non è valida") {
                    if (professorAccount) {
                        document.getElementById("emailValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("semailValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Nome non valido") {
                    if (professorAccount) {
                        document.getElementById("firstnameValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("sfirstnameValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Cognome non valido") {
                    if (professorAccount) {
                        document.getElementById("lastnameValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("slastnameValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Numero di telefono non valido") {
                    if (professorAccount) {
                        document.getElementById("phoneValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("sphoneValidation").classList.add("is-invalid")
                    }
                } else if (msg == "L'immagine non è stata caricata correttamente. File accettati: JPG") {
                    if (professorAccount) {
                        document.getElementById("inputFileToLoad").classList.add("is-invalid")
                    } else {
                        document.getElementById("sinputFileToLoad").classList.add("is-invalid")
                    }
                } else if (msg == "La password inserita non è sicura, deve contenere almeno 8 caratteri, una lettera maiuscola, un numero e un carattere speciale") {
                    if (professorAccount) {
                        document.getElementById("pwValidation").classList.add("is-invalid")
                        document.getElementById("rpwValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("spwValidation").classList.add("is-invalid")
                        document.getElementById("srpwValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Il prezzo inserito non è valido") {
                    document.getElementById("priceValidation").classList.add("is-invalid")
                } else if (msg == "Completa il campo ripeti password per continuare") {
                    if (professorAccount) {
                        document.getElementById("rpwValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("srpwValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Username non disponibile") {
                    if (professorAccount) {
                        document.getElementById("usernameValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("susernameValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Le due password inserite non corrispondono") {
                    if (professorAccount) {
                        document.getElementById("pwValidation").classList.add("is-invalid")
                        document.getElementById("rpwValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("spwValidation").classList.add("is-invalid")
                        document.getElementById("srpwValidation").classList.add("is-invalid")
                    }
                } else if (msg == "Esiste già un utente registrato con questo indirizzo email") {
                    if (professorAccount) {
                        document.getElementById("emailValidation").classList.add("is-invalid")
                    } else {
                        document.getElementById("semailValidation").classList.add("is-invalid")
                    }
                }

            } else if (this.readyState == 4 && this.status == 500) {

                //internal server error
                msg = jsondoc.message
                document.getElementById("hidden_div").setAttribute("class", "show_div");
                document.getElementById("alert_msg").innerHTML = msg


            }
        }


        xhttp.open("POST", "/api/v1/users", true);
        xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhttp.send(json);
    }


</script>



</html>